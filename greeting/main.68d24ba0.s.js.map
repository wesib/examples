{"version":3,"file":"main.68d24ba0.s.js","sources":["../../src/greeting/greeting-out.component.ts","../../src/greeting/greeting.component.ts","../../src/greeting/index.ts"],"sourcesContent":["import { ProduceStyle, Theme } from '@wesib/generic';\nimport { AttachShadow, Attribute, BootstrapWindow, Component, ComponentContext, Render } from '@wesib/wesib';\nimport { StypProperties, stypRules, StypRules } from 'style-producer';\nimport { DefaultStyle, Examples__NS, FormThemeSettings, inStyle, readonlyInStyle, ThemeSettings } from '../common';\n\n@Component(['greeting-out', Examples__NS])\n@AttachShadow()\nexport class GreetingOutComponent {\n\n  @Attribute()\n  name?: string;\n\n  constructor(private readonly _context: ComponentContext) {\n  }\n\n  @ProduceStyle()\n  style(): StypRules {\n    return this._context.get(Theme).style(GreetingOutStyle);\n  }\n\n  @Render()\n  render() {\n\n    const self = this;\n    const document = this._context.get(BootstrapWindow).document;\n    const content = document.createElement('span');\n\n    this._context.contentRoot.append(content);\n\n    return () => content.innerText = greetings();\n\n    function greetings() {\n\n      const name = self.name?.trim();\n\n      return name ? `Hello, ${name}!` : 'Hello!';\n    }\n  }\n\n}\n\nconst GreetingOut__qualifier = 'bex:greeting-out';\n\nfunction GreetingOutStyle(theme: Theme): StypRules {\n\n  const settings = theme.ref(ThemeSettings).read.keep;\n  const formSettings = theme.ref(FormThemeSettings).read.keep;\n  const { root: { rules } } = theme;\n\n  return stypRules(\n      rules.add(\n          { u: [':', 'host'], $: GreetingOut__qualifier },\n          formSettings.thru(inStyle),\n      )\n          .add(formSettings.thru(readonlyInStyle))\n          .add(settings.thru(greetFieldStyle)),\n      theme.style(DefaultStyle),\n  );\n}\n\nexport function greetFieldStyle(\n    {\n      $fontSize,\n    }: ThemeSettings,\n): StypProperties {\n  return {\n    display: 'block',\n    margin: `${$fontSize.div(2)} 0 0 0`,\n  };\n}\n","import { componentInElement, ComponentNode, ElementNode, ProduceStyle, Theme } from '@wesib/generic';\nimport { Component, ComponentContext } from '@wesib/wesib';\nimport { ValueSync } from 'fun-events';\nimport { InCssClasses, inCssInfo, InGroup, inGroup, inText, InValidation, requirePresent } from 'input-aspects';\nimport { StypProperties, stypRules, StypRules } from 'style-producer';\nimport { AppFeature, Examples__NS, InputStyle, ThemeSettings } from '../common';\nimport { greetFieldStyle, GreetingOutComponent } from './greeting-out.component';\n\nconst greetingInRef = componentInElement({\n  select: 'input',\n  build: node => inText(node.element)\n      .setup(InValidation, validation => validation.by(requirePresent))\n      .setup(InCssClasses, classes => classes.add(inCssInfo())),\n});\n\n@Component(\n    ['greeting', Examples__NS],\n    greetingInRef,\n    {\n      feature: {\n        needs: [\n          GreetingOutComponent,\n          AppFeature,\n        ],\n      },\n    },\n)\nexport class GreetingComponent {\n\n  constructor(private readonly _context: ComponentContext) {\n    _context.whenOn(supply => {\n\n      const greetingIn = _context.get(greetingInRef).tillOff(supply);\n      const group = inGroup<GreetData>({ name: '' });\n\n      greetingIn(name => group.controls.set('name', name))\n          .whenOff(() => group.controls.remove('name'));\n\n      const node = _context.get(ComponentNode);\n      const output = node.select(GreetingOutComponent, { deep: true }).first;\n      const sync = new ValueSync<string | null>('');\n\n      sync.sync(output, o => o?.attribute('name'));\n      sync.sync(\n          'in',\n          group.controls.read,\n          controls => controls?.get('name'),\n      );\n\n      supply.whenOff(() => sync.done());\n    });\n  }\n\n  @ProduceStyle()\n  style(): StypRules {\n    return this._context.get(Theme).style(GreetingStyle);\n  }\n\n  protected nodeControl(node: ElementNode): InGroup<GreetData> {\n\n    const group = inGroup<GreetData>({ name: '' });\n\n    group.controls.set(\n        'name',\n        inText(node.element)\n            .setup(InValidation, validation => validation.by(requirePresent))\n            .setup(InCssClasses, classes => classes.add(inCssInfo())),\n    );\n\n    return group;\n  }\n\n}\n\ninterface GreetData {\n  name: string;\n}\n\nconst Greeting__qualifier = 'bex:greeting';\n\nfunction GreetingStyle(theme: Theme): StypRules {\n\n  const settings = theme.ref(ThemeSettings).read.keep;\n  const { root: { rules } } = theme;\n  const label = rules.add(\n      [{ u: [':', 'host'] }, { e: 'label', $: Greeting__qualifier }],\n      settings.thru(greetLabelStyle),\n  );\n\n  return stypRules(\n      theme.style(InputStyle),\n      label,\n      label.rules.add(\n          { e: 'input', $: Greeting__qualifier },\n          settings.thru(greetFieldStyle),\n      ),\n  );\n}\n\nfunction greetLabelStyle(\n    {\n      $fontSize,\n    }: ThemeSettings,\n): StypProperties {\n  return {\n    display: 'block',\n    margin: 0,\n    padding: `${$fontSize.div(2)}`,\n  };\n}\n","import { examplesContext } from '../common';\nimport { GreetingComponent } from './greeting.component';\n\nexamplesContext.load(GreetingComponent);\n"],"names":["_context","this","GreetingOutComponent","get","Theme","style","GreetingOutStyle","self","content","BootstrapWindow","document","createElement","contentRoot","append","innerText","name","trim","__decorate","Attribute","ProduceStyle","Render","Component","Examples__NS","AttachShadow","GreetingOut__qualifier","theme","settings","ref","ThemeSettings","read","keep","formSettings","FormThemeSettings","rules","stypRules","add","u","$","thru","inStyle","readonlyInStyle","greetFieldStyle","DefaultStyle","_a","display","margin","div","greetingInRef","componentInElement","select","build","node","inText","element","setup","InValidation","validation","by","requirePresent","InCssClasses","classes","inCssInfo","whenOn","supply","greetingIn","tillOff","group","inGroup","controls","set","whenOff","remove","output","ComponentNode","deep","first","sync","ValueSync","o","attribute","done","GreetingComponent","GreetingStyle","feature","needs","AppFeature","Greeting__qualifier","label","e","greetLabelStyle","InputStyle","padding","examplesContext","load"],"mappings":"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"}